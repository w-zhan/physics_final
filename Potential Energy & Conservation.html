<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>ç‰©ç†å¯¦é©—å®¤ - ä½èƒ½èˆ‡èƒ½é‡å®ˆæ†</title>
    <style>
        :root {
            --phet-blue: #004a99;
            --control-bg: #e5f1d8;
            --panel-bg: #f8fafc;
            --sky-top: #87ceeb;
            --sky-bottom: #e0f6ff;
            --ke-green: #22c55e;
            --pe-blue: #3b82f6;
            --total-gold: #eab308;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif; }
        body { background-color: #334155; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }

        /* é ‚éƒ¨å°è¦½ */
        nav {
            background: linear-gradient(to bottom, #1e293b, #0f172a);
            height: 45px; display: flex; align-items: center; padding: 0 20px; border-bottom: 2px solid #000;
        }
        nav h1 { color: white; font-size: 18px; margin-right: 30px; }
        nav span { color: #10b981; font-size: 14px; font-weight: bold; border-bottom: 2px solid #10b981; }

        .main-container { display: flex; flex: 1; padding: 10px; gap: 10px; background: #cbd3e1; overflow: hidden; }

        /* å·¦å´æ¨¡æ“¬å€ */
        .simulation-container {
            flex: 1; background: linear-gradient(to bottom, var(--sky-top), var(--sky-bottom));
            border: 2px solid #555; border-radius: 8px; position: relative; display: flex; flex-direction: column;
        }
        canvas { width: 100%; flex: 1; display: block; }

        /* èƒ½é‡å³æ™‚åœ–è¡¨ (Bar Chart) */
        .energy-monitor {
            position: absolute; top: 20px; left: 20px; background: rgba(255,255,255,0.9);
            padding: 15px; border-radius: 8px; border: 1px solid #888; box-shadow: 2px 2px 10px rgba(0,0,0,0.1);
        }
        .bar-wrap { display: flex; align-items: flex-end; gap: 12px; height: 120px; }
        .bar { width: 25px; transition: height 0.05s linear; border-radius: 2px 2px 0 0; }
        .bar-label { font-size: 11px; font-weight: bold; text-align: center; margin-top: 5px; }

        /* ä¸‹æ–¹æ§åˆ¶å€åŸŸ */
        .bottom-controls {
            height: 180px; background: var(--control-bg); border-top: 2px solid #888;
            padding: 15px; display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .slider-row { width: 80%; display: flex; align-items: center; gap: 15px; margin: 5px 0; }
        input[type="range"] { flex: 1; accent-color: var(--phet-blue); }

        /* å³å´æ•™å­¸é¢æ¿ */
        .edu-panel {
            width: 420px; background: var(--panel-bg); border: 2px solid #888; border-radius: 8px;
            padding: 20px; display: flex; flex-direction: column; gap: 15px; overflow-y: auto;
        }
        .edu-section { background: white; border-left: 5px solid var(--phet-blue); padding: 15px; border-radius: 4px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .edu-title { font-weight: bold; color: var(--phet-blue); margin-bottom: 8px; font-size: 16px; border-bottom: 1px solid #eee; }
        .edu-content { font-size: 14px; line-height: 1.6; color: #334155; }
        
        /* å°è€ƒ */
        .quiz-option { 
            display: block; width: 100%; padding: 10px; margin: 8px 0; border: 1px solid #ddd; 
            background: #fff; border-radius: 6px; cursor: pointer; text-align: left; font-size: 13px;
        }
        .quiz-option:hover { background: #f1f5f9; }
        .feedback { margin-top: 10px; padding: 10px; border-radius: 4px; display: none; font-size: 13px; font-weight: bold; }

        .btn-reset { background: #ef4444; color: white; border: none; padding: 12px; border-radius: 6px; cursor: pointer; font-weight: bold; margin-top: auto; }
    </style>
</head>
<body>

<nav>
    <h1>ä½èƒ½èˆ‡èƒ½é‡å®ˆæ†åˆ†æ</h1>
</nav>

<div class="main-container">
    <div class="simulation-container">
        <div class="energy-monitor">
            <div class="bar-wrap">
                <div style="display:flex; flex-direction:column; align-items:center;">
                    <div id="bar-ke" class="bar" style="background:var(--ke-green); height:0px;"></div>
                    <div class="bar-label">å‹•èƒ½</div>
                </div>
                <div style="display:flex; flex-direction:column; align-items:center;">
                    <div id="bar-pe" class="bar" style="background:var(--pe-blue); height:0px;"></div>
                    <div class="bar-label">ä½èƒ½</div>
                </div>
                <div style="display:flex; flex-direction:column; align-items:center;">
                    <div id="bar-total" class="bar" style="background:var(--total-gold); height:0px;"></div>
                    <div class="bar-label">ç¸½èƒ½</div>
                </div>
            </div>
        </div>

        <canvas id="simCanvas"></canvas>

        <div class="bottom-controls">
            <div style="font-weight:bold; font-size:18px; color:#1e293b; margin-bottom:10px;">å¯¦é©—åƒæ•¸æ§åˆ¶</div>
            <div class="slider-row">
                <label>é‡åŠ› (g): <b id="val-g">9.8</b> m/sÂ²</label>
                <input type="range" id="slider-g" min="0" max="25" step="0.1" value="9.8">
            </div>
            <div class="slider-row">
                <label>è³ªé‡ (m): <b id="val-m">50</b> kg</label>
                <input type="range" id="slider-m" min="5" max="100" step="5" value="50">
            </div>
            <button id="btn-pause" style="padding:5px 20px; cursor:pointer;">æ’­æ”¾ / æš«åœ</button>
        </div>
    </div>

    <div class="edu-panel">
        <div class="edu-section">
            <div class="edu-title">ğŸ“– å®šç†è§£é‡‹ï¼šèƒ½é‡å®ˆæ†</div>
            <div class="edu-content">
                åœ¨æ²’æœ‰éä¿å®ˆåŠ›ï¼ˆå¦‚æ‘©æ“¦åŠ›ï¼‰ä½œåŠŸçš„æƒ…æ³ä¸‹ï¼Œç‰©é«”çš„æ©Ÿæ¢°èƒ½ï¼ˆå‹•èƒ½èˆ‡ä½èƒ½ä¹‹å’Œï¼‰ä¿æŒä¸è®Šã€‚
                <ul>
                    <li><b>é‡åŠ›ä½èƒ½ (PE)ï¼š</b> U = mgh</li>
                    <li><b>å‹•èƒ½ (KE)ï¼š</b> K = 1/2mv^2</li>
                    <li><b>èƒ½é‡å®ˆæ†ï¼š</b> PE_initial + KE_initial = PE_final + KE_final$</li>
                </ul>
            </div>
        </div>

        <div class="edu-section">
            <div class="edu-title">ğŸ§ª æ¢ç©¶ä»»å‹™</div>
            <div class="edu-content">
                1. <b>é«˜åº¦å¯¦é©—ï¼š</b>æ‰‹å‹•æ‹‰å‹•ã€Œä½ç½®æ»‘æ¡¿ã€å°‡æœ¨ç®±å‡åˆ°æœ€é«˜é»ï¼Œè§€å¯Ÿæ­¤æ™‚å‹•èƒ½æ¢æ˜¯å¦ç‚º 0ï¼Ÿ<br>
                2. <b>è‡ªç”±è½é«”ï¼š</b>é»æ“Šæ’­æ”¾ï¼Œè§€å¯Ÿæœ¨ç®±ä¸‹é™æ™‚ï¼Œä½èƒ½å¦‚ä½•è½‰åŒ–ç‚ºå‹•èƒ½ã€‚ç¸½èƒ½æ¢æœ‰è®Šå‹•å—ï¼Ÿ<br>
                3. <b>æ˜Ÿçƒæ¨¡æ“¬ï¼š</b>å°‡é‡åŠ›èª¿è‡³ 1.6 (æœˆçƒ)ï¼Œè§€å¯Ÿèƒ½é‡è½‰æ›çš„é€Ÿåº¦ã€‚
            </div>
        </div>

        <div class="edu-section" style="background: #fffbeb; border-left-color: #f59e0b;">
            <div class="edu-title">ğŸ“ éš¨å ‚å°è€ƒ</div>
            <div class="edu-content">
                <p><b>Qï¼šè‹¥ä¸è¨ˆæ‘©æ“¦åŠ›ï¼Œç‰©é«”å¾é«˜è™•è‡ªç”±è½ä¸‹ï¼Œå…¶ã€Œç¸½æ©Ÿæ¢°èƒ½ã€æœƒå¦‚ä½•è®ŠåŒ–ï¼Ÿ</b></p>
                <button class="quiz-option" onclick="checkQuiz(this, false, 'ä¸å°å–”ï¼Œä½èƒ½é›–ç„¶è®Šå°ï¼Œä½†æœƒè½‰åŒ–æˆå‹•èƒ½ã€‚')">é€æ¼¸è®Šå°</button>
                <button class="quiz-option" onclick="checkQuiz(this, true, 'æ­£ç¢ºï¼èƒ½é‡åªæ˜¯å½¢å¼è½‰æ›ï¼Œç¸½é‡ä¿æŒä¸è®Šã€‚')">ä¿æŒä¸è®Š</button>
                <button class="quiz-option" onclick="checkQuiz(this, false, 'ä¸å°ï¼Œé€Ÿåº¦å¢åŠ ä»£è¡¨å‹•èƒ½å¢åŠ ï¼Œä½†ä½èƒ½æ¸›å°‘äº†ã€‚')">é€æ¼¸è®Šå¤§</button>
                <div id="quiz-feedback" class="feedback"></div>
            </div>
        </div>

        <div class="edu-section">
            <div class="edu-title">ä½ç½®æ§åˆ¶ (é«˜åº¦)</div>
            <div style="text-align:center; font-weight:bold; margin-bottom:5px;">ç›®å‰é«˜åº¦: <span id="val-h">5.0</span> m</div>
            <input type="range" id="slider-h" min="0" max="10" step="0.1" value="5" style="width:100%;">
        </div>

        <button class="btn-reset" onclick="resetAll()">é‡è¨­å…¨éƒ¨å¯¦é©—æ•¸æ“š</button>
    </div>
</div>

<script>
    const canvas = document.getElementById('simCanvas');
    const ctx = canvas.getContext('2d');

    let st = { g: 9.8, m: 50, h: 5, v: 0, running: false };

    function resetAll() {
        st.v = 0; st.h = 5; st.running = false;
        document.getElementById('slider-h').value = 5;
        document.getElementById('quiz-feedback').style.display = 'none';
        updateUI();
    }

    function checkQuiz(btn, isCorrect, msg) {
        const feedback = document.getElementById('quiz-feedback');
        feedback.innerText = msg;
        feedback.style.display = 'block';
        feedback.style.color = isCorrect ? '#065f46' : '#991b1b';
        feedback.style.backgroundColor = isCorrect ? '#dcfce7' : '#fee2e2';
    }

    document.getElementById('slider-g').oninput = e => { st.g = parseFloat(e.target.value); updateUI(); };
    document.getElementById('slider-m').oninput = e => { st.m = parseInt(e.target.value); updateUI(); };
    document.getElementById('slider-h').oninput = e => { st.h = parseFloat(e.target.value); st.v = 0; st.running = false; updateUI(); };
    document.getElementById('btn-pause').onclick = () => st.running = !st.running;

    function updateUI() {
        document.getElementById('val-g').innerText = st.g.toFixed(1);
        document.getElementById('val-m').innerText = st.m;
        document.getElementById('val-h').innerText = st.h.toFixed(1);
    }

    function physics() {
        if (!st.running) return;
        
        let accel = -st.g;
        st.v += accel * 0.016;
        st.h += st.v * 0.016;

        if (st.h <= 0) {
            st.h = 0;
            st.v = -st.v * 0.5; // å½ˆè·³æè€—
            if (Math.abs(st.v) < 0.5) { st.v = 0; st.running = false; }
        }
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        const cw = canvas.width, ch = canvas.height, groundY = ch - 60;
        const scale = (ch - 150) / 10;
        const objY = groundY - (st.h * scale);
        const objX = cw / 2;

        // èƒ½é‡æ¢è¨ˆç®—
        let pe = st.m * st.g * st.h;
        let ke = 0.5 * st.m * st.v * st.v;
        let total = pe + ke;
        let bScale = 0.01; // é¡¯ç¤ºæ¯”ä¾‹

        document.getElementById('bar-pe').style.height = Math.min(pe * bScale, 120) + "px";
        document.getElementById('bar-ke').style.height = Math.min(ke * bScale, 120) + "px";
        document.getElementById('bar-total').style.height = Math.min(total * bScale, 120) + "px";

        // èƒŒæ™¯åœ°å±¤
        ctx.fillStyle = "#8b5a2b"; ctx.fillRect(0, groundY, cw, 60);
        
        // åˆ»åº¦
        ctx.fillStyle = "#333";
        for(let i=0; i<=10; i++) {
            let ty = groundY - (i * scale);
            ctx.fillRect(objX - 100, ty, 200, 1);
            ctx.font = "10px Arial";
            ctx.fillText(i + "m", objX - 120, ty + 4);
        }

        // ç•«æœ¨ç®±
        const bz = 40 + st.m/4;
        ctx.fillStyle = "#d2b48c"; ctx.strokeStyle = "#5d4037"; ctx.lineWidth = 3;
        ctx.fillRect(objX - bz/2, objY - bz, bz, bz);
        ctx.strokeRect(objX - bz/2, objY - bz, bz, bz);

        // å‘é‡ç®­é ­ (é€Ÿåº¦)
        if (Math.abs(st.v) > 0.2) {
            drawArrow(objX + bz, objY - bz/2, 0, -st.v * 5, "#22c55e", "é€Ÿåº¦ v");
        }

        physics();
        updateUI();
        requestAnimationFrame(draw);
    }

    function drawArrow(x, y, dx, dy, col, lab) {
        ctx.strokeStyle = col; ctx.fillStyle = col; ctx.lineWidth = 4;
        ctx.beginPath(); ctx.moveTo(x, y); ctx.lineTo(x + dx, y + dy); ctx.stroke();
        ctx.fillText(lab, x + dx + 5, y + dy + 5);
    }

    window.onload = () => {
        canvas.width = canvas.offsetWidth;
        canvas.height = canvas.offsetHeight;
        draw();
    };
</script>
</body>
</html>
